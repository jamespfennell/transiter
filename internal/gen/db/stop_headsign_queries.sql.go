// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.17.2
// source: stop_headsign_queries.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const deleteStopHeadsignRules = `-- name: DeleteStopHeadsignRules :exec
DELETE FROM stop_headsign_rule
WHERE stop_headsign_rule.feed_pk = $1
`

func (q *Queries) DeleteStopHeadsignRules(ctx context.Context, feedPk int64) error {
	_, err := q.db.Exec(ctx, deleteStopHeadsignRules, feedPk)
	return err
}

const insertStopHeadSignRule = `-- name: InsertStopHeadSignRule :exec
INSERT INTO stop_headsign_rule
    (feed_pk, priority, stop_pk, track, headsign)
VALUES
    ($1, $2, $3,
     $4, $5)
`

type InsertStopHeadSignRuleParams struct {
	FeedPk   int64
	Priority int32
	StopPk   int64
	Track    pgtype.Text
	Headsign string
}

func (q *Queries) InsertStopHeadSignRule(ctx context.Context, arg InsertStopHeadSignRuleParams) error {
	_, err := q.db.Exec(ctx, insertStopHeadSignRule,
		arg.FeedPk,
		arg.Priority,
		arg.StopPk,
		arg.Track,
		arg.Headsign,
	)
	return err
}

const listStopHeadsignRulesForFeed = `-- name: ListStopHeadsignRulesForFeed :many
SELECT stop.id as stop_id, priority, track, headsign FROM stop_headsign_rule
INNER JOIN stop ON stop.pk = stop_headsign_rule.stop_pk
WHERE stop_headsign_rule.feed_pk = $1
`

type ListStopHeadsignRulesForFeedRow struct {
	StopID   string
	Priority int32
	Track    pgtype.Text
	Headsign string
}

func (q *Queries) ListStopHeadsignRulesForFeed(ctx context.Context, feedPk int64) ([]ListStopHeadsignRulesForFeedRow, error) {
	rows, err := q.db.Query(ctx, listStopHeadsignRulesForFeed, feedPk)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListStopHeadsignRulesForFeedRow
	for rows.Next() {
		var i ListStopHeadsignRulesForFeedRow
		if err := rows.Scan(
			&i.StopID,
			&i.Priority,
			&i.Track,
			&i.Headsign,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listStopHeadsignRulesForStops = `-- name: ListStopHeadsignRulesForStops :many
SELECT pk, priority, stop_pk, track, headsign, feed_pk FROM stop_headsign_rule
WHERE stop_pk = ANY($1::bigint[])
ORDER BY priority ASC
`

func (q *Queries) ListStopHeadsignRulesForStops(ctx context.Context, stopPks []int64) ([]StopHeadsignRule, error) {
	rows, err := q.db.Query(ctx, listStopHeadsignRulesForStops, stopPks)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []StopHeadsignRule
	for rows.Next() {
		var i StopHeadsignRule
		if err := rows.Scan(
			&i.Pk,
			&i.Priority,
			&i.StopPk,
			&i.Track,
			&i.Headsign,
			&i.FeedPk,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
